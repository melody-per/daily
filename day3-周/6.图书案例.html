<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
         <style type="text/css">
    .grid {
      margin: auto;
      width: 530px;
      text-align: center;
    }
    .grid table {
      border-top: 1px solid #C2D89A;
      width: 100%;
      border-collapse: collapse;
    }
    .grid th,td {
      padding: 10;
      border: 1px dashed #F3DCAB;
      height: 35px;
      line-height: 35px;
    }
    .grid th {
      background-color: #F3DCAB;
    }
    .grid .book {
      padding-bottom: 10px;
      padding-top: 5px;
      background-color: #F3DCAB;
    }
    .grid .total {
      height: 30px;
      line-height: 30px;
      background-color: #F3DCAB;
      border-top: 1px solid #C2D89A;
    }
    </style>
  </head>
  <body>
    <div id="app">
      <div class="grid">
        <div>
          <h1>图书管理</h1>
          <div class="book">
            <div>
              <label for="id"> 编号： </label> 
              <input type="text" id="id" disabled v-model="id"  />
              <label for="name"> 名称： </label>
              <input type="text" id="name" v-model="name" /> 
              <button @click="add_res" :disabled="on_off">提交</button>
            </div>
          </div>
        </div>
        <div class="total"><span>图书总数：</span> <span v-text="booksLength"></span></div>
        <table>
          <thead>
            <tr>
              <th>编号</th>
              <th>名称</th>
              <th>时间</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="(item,index) in books" :key="item.id">
              <td v-text="index+1"></td>
              <td v-text="item.name"></td>
              <td v-text="item.time"></td>
              <td><a href="javaScript:;" @click='res(index)'>修改</a> <span>|</span> <a href="javaScript:;" @click="del(index)">删除</a></td>
            </tr>

          </tbody>
        </table>
      </div>
    </div>
    <script src="vue.js"></script>
    <script>
      //获取当前年月日星期几几点几分几秒并打印
      function getTimer(a) {
        var date = new Date(a)
        var week = ['星期日', '星期一', '星期二', '星期三', '星	期四', '星期五', '星期六']
        var year = date.getFullYear()
        var month = date.getMonth() + 1
        var datee = date.getDate()
        var day = date.getDay()
        var time = year + '年' + (month<10?'0'+month:month) + '月' + (datee<10?'0'+datee:datee) + '日   	'
        function getTimerr() {
          var time = date
          var hour = time.getHours()
          hour = hour < 10 ? '0' + hour : hour
          var minute = time.getMinutes()
          minute = minute < 10 ? '0' + minute : minute
          var second = time.getSeconds()
          second = second < 10 ? '0' + second : second
          return hour + ':' + minute + ':' + second
        }
        return time + ' ' + getTimerr()
      }
      new Vue({
        el: "#app",
        data: {
          id:'',
          name:'',
          books:[
            {id:1,name:'一国',time:getTimer(1591309551051) },
            {id:2,name:'二国',time:getTimer(1597401533651) },
            {id:3,name:'三国',time:getTimer(1599305511651) },
          ],
          on_off:false,
          on_off2:false,
          num:0
        },
        methods: {
          //增加(修改)
          add_res(){
            //判断输入是否有值
            if(!this.name)return;
            //判断是修改还是增加图书
            if(!this.on_off2){
              this.books.push({
              id:this.books.length?this.books[this.books.length-1].id+1:1,
              name:this.name ,
              time:getTimer(+new Date())    ,              
               })
            this.on_off2=false
            }else{
              this.books[this.id-1].name=this.name
              this.on_off2=true
            }
            //清空输入框
            this.id='',
            this.name=''            
          },
          //点击修改
          res(index){
            this.on_off=true;
            this.on_off2=true;
            this.name=this.books[index].name,
            this.id=index+1,
            this.num=index
          },
          //点击删除
          del(index){
            // 通过下标删除数组
            this.books.splice(index,1)
          },
        },
        watch: {
          name(){
            for (let i = 0; i < this.books.length; i++) {
              if(this.name==this.books[i].name){
                return this.on_off=true;
            }else{
              this.on_off=false
            };
            }
          }
        },
        computed:{
          //计算输出(书)数组长度
          booksLength(){
            return this.books.length
          }
        }
      });
    </script>
  </body>
</html>
